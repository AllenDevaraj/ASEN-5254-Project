<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="dual_panda">
  
  <gazebo>
    <plugin filename="gz-sim-pose-publisher-system" name="gz::sim::systems::PosePublisher">
      <publish_link_pose>true</publish_link_pose>
      <use_pose_vector_msg>false</use_pose_vector_msg>
      <static_publisher>false</static_publisher>
      <static_update_frequency>60</static_update_frequency>
    </plugin>
  </gazebo>

  <!-- World link (common) -->
  <link name="world"/>
  
  <!-- ========================================== -->
  <!-- PANDA 1 (Left arm, at x=0.0, y=0.15) -->
  <!-- ========================================== -->
  <joint name="panda1_joint_world" type="fixed">
    <parent link="world"/>
    <child link="panda1_link0"/>
    <origin rpy="0 0 0" xyz="0 0.15 0"/>
  </joint>
  
  <!-- Include Panda 1 using xacro property substitution for prefixing -->
  <xacro:property name="panda1_prefix" value="panda1_"/>
  <xacro:include filename="$(find panda_ign_description)/panda/panda.urdf"/>
  
  <!-- We need to manually prefix Panda 1, but since we can't easily do that with included URDF,
       let's create Panda 1 directly with prefixes -->
  
  <!-- Actually, we'll need to manually duplicate the panda.urdf content with panda1_ prefix -->
  <!-- This is complex, so let's use a simpler approach: spawn them separately but use unified MoveIt -->
  
  <!-- For now, let's create a simpler version that references the existing URDFs -->
  <!-- We'll spawn them via world file or separately, but MoveIt will see them as one robot -->
  
  <!-- TEMPORARY APPROACH: Include base panda and manually create second one -->
  <!-- This file will be processed differently in the launch file -->
  
  <!-- Panda 1 base link -->
  <link name="panda1_link0">
    <inertial>
      <mass value="2.92"/>
      <origin rpy="0 0 0" xyz="-0.025566 -2.88e-05 0.057332"/>
      <inertia ixx="0.00782229414331" ixy="-1.56191622996e-05" ixz="-0.00126005738123" iyy="0.0109027971813" iyz="1.08233858202e-05" izz="0.0102355503949"/>
    </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="model://panda/meshes/visual/link0.dae"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <mesh filename="model://panda/meshes/collision/link0.stl"/>
      </geometry>
    </collision>
  </link>
  
  <!-- Continue with all panda1 links and joints... -->
  <!-- This would be very long, so we'll use a different approach -->
  
</robot>
